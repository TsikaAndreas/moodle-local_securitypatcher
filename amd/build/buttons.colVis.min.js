(function(t){if(typeof define==="function"&&define.amd){define(["jquery","local_codepatcher/jquery.dataTables","local_codepatcher/dataTables.buttons"],function(n){return t(n,window,document)})}else if(typeof exports==="object"){var o=require("jquery");var i=function(n,e){if(!e.fn.dataTable){require("datatables.net")(n,e)}if(!e.fn.dataTable.Buttons){require("datatables.net-buttons")(n,e)}};if(typeof window==="undefined"){module.exports=function(n,e){if(!n){n=window}if(!e){e=o(n)}i(n,e);return t(e,n,n.document)}}else{i(window,o);module.exports=t(o,window,window.document)}}else{t(jQuery,window,document)}})(function(n,e,t,u){"use strict";var o=n.fn.dataTable;n.extend(o.ext.buttons,{colvis:function(o,i){var l=null;var n={extend:"collection",init:function(n,e){l=e},text:function(n){return n.i18n("buttons.colvis","Column visibility")},className:"buttons-colvis",closeButton:false,buttons:[{extend:"columnsToggle",columns:i.columns,columnText:i.columnText}]};o.on("column-reorder.dt"+i.namespace,function(n,e,t){o.button(null,o.button(null,l).node()).collectionRebuild([{extend:"columnsToggle",columns:i.columns,columnText:i.columnText}])});return n},columnsToggle:function(n,e){var t=n.columns(e.columns).indexes().map(function(n){return{extend:"columnToggle",columns:n,columnText:e.columnText}}).toArray();return t},columnToggle:function(n,e){return{extend:"columnVisibility",columns:e.columns,columnText:e.columnText}},columnsVisibility:function(n,e){var t=n.columns(e.columns).indexes().map(function(n){return{extend:"columnVisibility",columns:n,visibility:e.visibility,columnText:e.columnText}}).toArray();return t},columnVisibility:{columns:u,text:function(n,e,t){return t._columnText(n,t)},className:"buttons-columnVisibility",action:function(n,e,t,o){var i=e.columns(o.columns);var l=i.visible();i.visible(o.visibility!==u?o.visibility:!(l.length?l[0]:false))},init:function(o,n,i){var l=this;n.attr("data-cv-idx",i.columns);o.on("column-visibility.dt"+i.namespace,function(n,e){if(!e.bDestroying&&e.nTable==o.settings()[0].nTable){l.active(o.column(i.columns).visible())}}).on("column-reorder.dt"+i.namespace,function(n,e,t){if(i.destroying){return}if(o.columns(i.columns).count()!==1){return}l.text(i._columnText(o,i));l.active(o.column(i.columns).visible())});this.active(o.column(i.columns).visible())},destroy:function(n,e,t){n.off("column-visibility.dt"+t.namespace).off("column-reorder.dt"+t.namespace)},_columnText:function(n,e){var t=n.column(e.columns).index();var o=n.settings()[0].aoColumns[t].sTitle;if(!o){o=n.column(t).header().innerHTML}o=o.replace(/\n/g," ").replace(/<br\s*\/?>/gi," ").replace(/<select(.*?)<\/select>/g,"").replace(/<!\-\-.*?\-\->/g,"").replace(/<.*?>/g,"").replace(/^\s+|\s+$/g,"");return e.columnText?e.columnText(n,t,o):o}},colvisRestore:{className:"buttons-colvisRestore",text:function(n){return n.i18n("buttons.colvisRestore","Restore visibility")},init:function(e,n,t){t._visOriginal=e.columns().indexes().map(function(n){return e.column(n).visible()}).toArray()},action:function(n,t,e,o){t.columns().every(function(n){var e=t.colReorder&&t.colReorder.transpose?t.colReorder.transpose(n,"toOriginal"):n;this.visible(o._visOriginal[e])})}},colvisGroup:{className:"buttons-colvisGroup",action:function(n,e,t,o){e.columns(o.show).visible(true,false);e.columns(o.hide).visible(false,false);e.columns.adjust()},show:[],hide:[]}});return o});